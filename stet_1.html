<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Bihar STET Mock Test - Art of Teaching & Other Skills">
    <title>Bihar STET Mock Test - Art of Teaching & Other Skills</title>
    
    <!-- External Resources -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* CSS Variables for Theme - Matching main index */
        :root {
            --color-bg-deep: #0F0F14;
            --color-card-dark: #1A1A24;
            --color-primary: #5B5FFF;
            --color-accent: #D4AF37;
            --color-text-light: #E8E8F0;
            --color-text-muted: #A0A0B8;
            --color-gradient-start: #1A1A24;
            --color-gradient-end: #0F0F14;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
        }

        /* Base Styles */
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background-color: var(--color-bg-deep);
            color: var(--color-text-light);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Container Styles */
        .test-container {
            background-color: var(--color-card-dark);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }

        /* Timer Styles */
        .timer-container {
            background: linear-gradient(135deg, var(--color-primary) 0%, #4A4AFF 100%);
            color: var(--color-bg-deep);
            border-radius: 0.5rem;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .timer-display {
            font-family: 'Courier New', monospace;
            font-size: 2rem;
            font-weight: bold;
            letter-spacing: 0.05em;
        }

        .timer-warning {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        /* Question Styles */
        .question-block {
            background-color: rgba(26, 26, 36, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }

        .option-label {
            transition: all 0.2s ease;
            background-color: rgba(15, 15, 20, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .option-label:hover {
            background-color: rgba(91, 95, 255, 0.1);
            border-color: rgba(91, 95, 255, 0.3);
        }

        .option-label.selected {
            background-color: rgba(91, 95, 255, 0.2);
            border-color: var(--color-primary);
        }

        /* Button Styles */
        .btn-primary {
            background: linear-gradient(135deg, var(--color-primary) 0%, #4A4AFF 100%);
            color: var(--color-bg-deep);
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(91, 95, 255, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(91, 95, 255, 0.6);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background-color: transparent;
            border: 2px solid var(--color-accent);
            color: var(--color-accent);
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
        }

        /* Answer Feedback Styles */
        .correct-answer {
            background-color: rgba(16, 185, 129, 0.2);
            border-left: 4px solid var(--success-color);
        }

        .incorrect-answer {
            background-color: rgba(239, 68, 68, 0.2);
            border-left: 4px solid var(--error-color);
        }

        .unanswered {
            background-color: rgba(245, 158, 11, 0.2);
            border-left: 4px solid var(--warning-color);
        }

        .review-block .options-list label {
            cursor: default;
        }

        /* Progress Bar */
        .progress-container {
            height: 8px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--color-primary), var(--color-accent));
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Question Navigation */
        .question-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
        }

        .question-indicator {
            display: flex;
            gap: 0.5rem;
        }

        .indicator-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .indicator-dot.active {
            background-color: var(--color-primary);
            transform: scale(1.2);
        }

        .indicator-dot.answered {
            background-color: var(--color-accent);
        }

        /* Result Styles */
        .score-summary {
            border-radius: 0.5rem;
            padding: 1.5rem;
            font-weight: 600;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(26, 26, 36, 0.8) 0%, rgba(26, 26, 36, 0.6) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 0.5rem;
            padding: 1rem;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        /* Responsive Adjustments */
        @media (max-width: 640px) {
            .timer-display {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Header -->
    <header class="p-4 flex justify-between items-center">
        <h1 class="text-2xl font-extrabold text-white flex items-center">
            <span class="text-accent mr-2">P</span>ijus Sir's Academy
        </h1>
        <button id="backToDashboard" class="btn-secondary py-2 px-4 rounded-lg font-bold">
            <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
        </button>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto p-4 sm:p-6 lg:p-8 max-w-4xl">
        <!-- Test Container -->
        <div id="test-container" class="test-container p-8 rounded-lg">
            <header class="border-b border-gray-700 pb-4 mb-6">
                <h1 class="text-3xl font-bold text-white text-center">Bihar STET Mock Test</h1>
                <h2 class="text-xl text-gray-400 text-center mt-2">Art of Teaching & Other Skills</h2>
                
                <!-- Timer Section -->
                <div class="timer-container mt-6">
                    <div id="timer" class="timer-display">45:00</div>
                    <p class="text-sm opacity-90">Time Remaining</p>
                </div>

                <!-- Progress Bar -->
                <div class="progress-container">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>
                <div class="flex justify-between text-sm text-gray-400">
                    <span>Question <span id="current-question">1</span> of <span id="total-questions">41</span></span>
                    <span id="answered-count">0 answered</span>
                </div>
            </header>
            
            <!-- Single Question Container -->
            <div id="question-container" class="question-block p-6 rounded-lg">
                <div id="question-content">
                    <!-- Question will be injected here by JavaScript -->
                </div>
                
                <div class="question-nav">
                    <button id="prev-btn" class="btn-secondary py-2 px-4 rounded-lg font-bold" disabled>
                        <i class="fas fa-arrow-left mr-2"></i>Previous
                    </button>
                    
                    <div class="question-indicator" id="question-indicator">
                        <!-- Question indicators will be injected here -->
                    </div>
                    
                    <button id="next-btn" class="btn-primary py-2 px-4 rounded-lg font-bold">
                        Next<i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
            
            <div class="mt-8 text-center">
                <button type="button" id="submit-btn" class="btn-primary py-3 px-8 rounded-lg">
                    <i class="fas fa-paper-plane mr-2"></i>Submit Test
                </button>
            </div>
        </div>

        <!-- Results Container -->
        <div id="results-container" class="test-container p-8 rounded-lg hidden">
            <header class="text-center mb-6">
                <h2 class="text-3xl font-bold text-white">Test Results</h2>
                <p class="text-gray-400 mt-2">Art of Teaching & Other Skills</p>
            </header>
            
            <div id="score-summary" class="score-summary text-center text-2xl font-semibold mb-6 p-4 rounded-md">
                <!-- Score will be displayed here -->
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="stat-card text-center">
                    <div class="text-2xl font-bold text-green-400" id="correct-count">0</div>
                    <div class="text-sm text-gray-400">Correct Answers</div>
                </div>
                <div class="stat-card text-center">
                    <div class="text-2xl font-bold text-red-400" id="incorrect-count">0</div>
                    <div class="text-sm text-gray-400">Incorrect Answers</div>
                </div>
                <div class="stat-card text-center">
                    <div class="text-2xl font-bold text-yellow-400" id="unanswered-count">0</div>
                    <div class="text-sm text-gray-400">Unanswered</div>
                </div>
            </div>
            
            <div id="answers-review" class="space-y-6">
                <!-- Review of answers will be injected here -->
            </div>
            
            <div class="mt-8 text-center space-x-4">
                <button id="retake-btn" class="btn-primary py-3 px-8 rounded-lg">
                    <i class="fas fa-redo mr-2"></i>Retake Test
                </button>
                <button id="backToDashboardBtn" class="btn-secondary py-3 px-8 rounded-lg">
                    <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
                </button>
            </div>
        </div>
    </main>

    <script>
        // Test Data
        const testData = {
            "sectionA": [
                {
                    "question": "Which of the following best describes the primary goal of teaching?",
                    "options": [
                        "To complete the syllabus",
                        "To help students pass exams",
                        "To facilitate holistic learning and development",
                        "To maintain classroom discipline"
                    ],
                    "answer": "To facilitate holistic learning and development"
                },
                {
                    "question": "Learning is a process of:",
                    "options": [
                        "Memorizing facts",
                        "Acquiring knowledge, skills, and attitudes",
                        "Passive reception of information",
                        "Following instructions strictly"
                    ],
                    "answer": "Acquiring knowledge, skills, and attitudes"
                },
                {
                    "question": "A key characteristic of effective teaching is that it is:",
                    "options": [
                        "Teacher-centered",
                        "Lecture-based",
                        "Student-centered and interactive",
                        "Strictly structured"
                    ],
                    "answer": "Student-centered and interactive"
                },
                {
                    "question": "According to Bloom's Taxonomy, the highest level of cognitive learning is:",
                    "options": [
                        "Understanding",
                        "Applying",
                        "Creating",
                        "Analyzing"
                    ],
                    "answer": "Creating"
                },
                {
                    "question": "\"To list the main causes of World War II\" is an example of an instructional objective at which cognitive level?",
                    "options": [
                        "Knowledge (Remembering)",
                        "Application",
                        "Analysis",
                        "Evaluation"
                    ],
                    "answer": "Knowledge (Remembering)"
                },
                {
                    "question": "The lecture method is most effective for:",
                    "options": [
                        "Developing practical skills",
                        "Fostering critical thinking",
                        "Introducing new topics to a large audience",
                        "Encouraging collaborative learning"
                    ],
                    "answer": "Introducing new topics to a large audience"
                },
                {
                    "question": "What is the primary advantage of a discussion method in teaching?",
                    "options": [
                        "It saves teaching time",
                        "It ensures uniform understanding",
                        "It promotes critical thinking and diverse perspectives",
                        "It allows the teacher to dominate"
                    ],
                    "answer": "It promotes critical thinking and diverse perspectives"
                },
                {
                    "question": "Project method of teaching is based on the principle of:",
                    "options": [
                        "Rote memorization",
                        "Learning by doing",
                        "Teacher demonstration",
                        "Passive listening"
                    ],
                    "answer": "Learning by doing"
                },
                {
                    "question": "A lesson plan should ideally begin with:",
                    "options": [
                        "Listing homework assignments",
                        "Stating learning objectives",
                        "Dividing students into groups",
                        "Conducting a quick test"
                    ],
                    "answer": "Stating learning objectives"
                },
                {
                    "question": "Which type of lesson plan focuses on student activity and direct experience?",
                    "options": [
                        "Herbartian model",
                        "Constructivist model",
                        "Behaviorist model",
                        "Eclectic model"
                    ],
                    "answer": "Constructivist model"
                },
                {
                    "question": "Microteaching is a technique used for:",
                    "options": [
                        "Teaching large groups of students",
                        "Developing specific teaching skills in a controlled environment",
                        "Conducting comprehensive assessments",
                        "Curriculum design"
                    ],
                    "answer": "Developing specific teaching skills in a controlled environment"
                },
                {
                    "question": "What is the main purpose of instructional analysis?",
                    "options": [
                        "To evaluate student performance",
                        "To break down complex skills into simpler components",
                        "To select appropriate textbooks",
                        "To manage classroom discipline"
                    ],
                    "answer": "To break down complex skills into simpler components"
                },
                {
                    "question": "An effective classroom ecosystem is characterized by:",
                    "options": [
                        "Strict teacher control",
                        "High competition among students",
                        "Mutual respect and collaboration",
                        "Silent and passive learners"
                    ],
                    "answer": "Mutual respect and collaboration"
                },
                {
                    "question": "Promoting a positive classroom environment primarily involves:",
                    "options": [
                        "Decorating the classroom beautifully",
                        "Setting clear expectations and fostering respect",
                        "Minimizing student interaction",
                        "Assigning excessive homework"
                    ],
                    "answer": "Setting clear expectations and fostering respect"
                },
                {
                    "question": "What is the primary role of a textbook in the teaching-learning process?",
                    "options": [
                        "To replace the teacher's instruction",
                        "To provide a structured source of information",
                        "To be the sole source of knowledge",
                        "To dictate the entire curriculum"
                    ],
                    "answer": "To provide a structured source of information"
                },
                {
                    "question": "A school library plays a crucial role in promoting:",
                    "options": [
                        "Rote memorization",
                        "Independent learning and research skills",
                        "Only fictional reading",
                        "Social media usage"
                    ],
                    "answer": "Independent learning and research skills"
                },
                {
                    "question": "A desirable quality for a teacher is:",
                    "options": [
                        "Rigidity in rules",
                        "Empathy and patience",
                        "Unwillingness to adapt",
                        "Preference for lecturing"
                    ],
                    "answer": "Empathy and patience"
                },
                {
                    "question": "What is the most important quality for a teacher to possess for classroom management?",
                    "options": [
                        "Strictness",
                        "Sense of humor",
                        "Consistency and fairness",
                        "Loud voice"
                    ],
                    "answer": "Consistency and fairness"
                },
                {
                    "question": "Formative assessment is primarily used for:",
                    "options": [
                        "Grading students at the end of a unit",
                        "Providing ongoing feedback for improvement",
                        "Comparing student performance with others",
                        "Certifying mastery of content"
                    ],
                    "answer": "Providing ongoing feedback for improvement"
                },
                {
                    "question": "What is the main purpose of summative assessment?",
                    "options": [
                        "To identify learning difficulties early on",
                        "To measure overall learning and achievement at the end of a period",
                        "To guide instructional adjustments during a lesson",
                        "To encourage peer collaboration"
                    ],
                    "answer": "To measure overall learning and achievement at the end of a period"
                },
                {
                    "question": "A diagnostic test helps a teacher to:",
                    "options": [
                        "Assign final grades",
                        "Identify specific learning difficulties of students",
                        "Compare students' intelligence levels",
                        "Measure the effectiveness of teaching aids"
                    ],
                    "answer": "Identify specific learning difficulties of students"
                },
                {
                    "question": "Curriculum can be defined as:",
                    "options": [
                        "Only the textbooks prescribed",
                        "The entire planned learning experience",
                        "A list of subjects taught",
                        "The daily timetable"
                    ],
                    "answer": "The entire planned learning experience"
                },
                {
                    "question": "The 'hidden curriculum' refers to:",
                    "options": [
                        "Subjects not officially taught",
                        "Unintended lessons and values learned in school",
                        "Secret assignments given to students",
                        "Optional extracurricular activities"
                    ],
                    "answer": "Unintended lessons and values learned in school"
                },
                {
                    "question": "Which of the following is an affective factor influencing learning?",
                    "options": [
                        "Intelligence quotient",
                        "Prior knowledge",
                        "Motivation and self-esteem",
                        "Physical health"
                    ],
                    "answer": "Motivation and self-esteem"
                },
                {
                    "question": "Teacher's competency directly impacts:",
                    "options": [
                        "School infrastructure",
                        "Student learning outcomes",
                        "Parents' income levels",
                        "Government policies"
                    ],
                    "answer": "Student learning outcomes"
                },
                {
                    "question": "The use of teaching aids helps in:",
                    "options": [
                        "Making teaching more efficient and effective",
                        "Reducing the need for teacher explanation",
                        "Increasing the workload for students",
                        "Distracting students from the lesson"
                    ],
                    "answer": "Making teaching more efficient and effective"
                },
                {
                    "question": "Which of the following is an example of a visual teaching aid?",
                    "options": [
                        "Audio recording",
                        "Podcast",
                        "Blackboard",
                        "Radio"
                    ],
                    "answer": "Blackboard"
                },
                {
                    "question": "Hands-on learning promotes:",
                    "options": [
                        "Passive observation",
                        "Memorization of theories",
                        "Deeper understanding and skill development",
                        "Teacher-led instruction only"
                    ],
                    "answer": "Deeper understanding and skill development"
                },
                {
                    "question": "Experiential learning emphasizes:",
                    "options": [
                        "Textbook reading",
                        "Direct experience and reflection",
                        "Listening to lectures",
                        "Rote learning"
                    ],
                    "answer": "Direct experience and reflection"
                },
                {
                    "question": "How many students are typically involved in a microteaching session?",
                    "options": [
                        "20-30 students",
                        "50-60 students",
                        "5-10 students",
                        "More than 100 students"
                    ],
                    "answer": "5-10 students"
                }
            ],
            "sectionB": [
                {
                    "question": "What is the capital of Japan?",
                    "options": [
                        "Beijing",
                        "Seoul",
                        "Tokyo",
                        "Bangkok"
                    ],
                    "answer": "Tokyo"
                },
                {
                    "question": "Who wrote the play \"Romeo and Juliet\"?",
                    "options": [
                        "Charles Dickens",
                        "William Shakespeare",
                        "Jane Austen",
                        "Mark Twain"
                    ],
                    "answer": "William Shakespeare"
                },
                {
                    "question": "Which continent is the Sahara Desert located on?",
                    "options": [
                        "Asia",
                        "Africa",
                        "South America",
                        "Australia"
                    ],
                    "answer": "Africa"
                },
                {
                    "question": "What is the chemical symbol for water?",
                    "options": [
                        "CO2",
                        "O2",
                        "H2O",
                        "N2"
                    ],
                    "answer": "H2O"
                },
                {
                    "question": "Which year did India gain independence?",
                    "options": [
                        "1945",
                        "1950",
                        "1947",
                        "1962"
                    ],
                    "answer": "1947"
                },
                {
                    "question": "Which gas is primarily responsible for the greenhouse effect?",
                    "options": [
                        "Oxygen",
                        "Nitrogen",
                        "Carbon Dioxide",
                        "Hydrogen"
                    ],
                    "answer": "Carbon Dioxide"
                },
                {
                    "question": "What is the term for the variety of life on Earth?",
                    "options": [
                        "Ecology",
                        "Biodiversity",
                        "Ecosystem",
                        "Habitat"
                    ],
                    "answer": "Biodiversity"
                },
                {
                    "question": "Which human activity is a major cause of deforestation?",
                    "options": [
                        "Reforestation",
                        "Agriculture and logging",
                        "Wind energy production",
                        "Recycling programs"
                    ],
                    "answer": "Agriculture and logging"
                },
                {
                    "question": "What is the process by which plants convert light energy into chemical energy?",
                    "options": [
                        "Respiration",
                        "Transpiration",
                        "Photosynthesis",
                        "Germination"
                    ],
                    "answer": "Photosynthesis"
                },
                {
                    "question": "Acid rain is caused by the emission of:",
                    "options": [
                        "Oxygen and Nitrogen",
                        "Sulfur dioxide and Nitrogen oxides",
                        "Carbon monoxide and Methane",
                        "Water vapor and Ozone"
                    ],
                    "answer": "Sulfur dioxide and Nitrogen oxides"
                },
                {
                    "question": "If a shirt costs $25 and is on sale for 20% off, what is the sale price?",
                    "options": [
                        "$20",
                        "$22",
                        "$18",
                        "$24"
                    ],
                    "answer": "$20"
                },
                {
                    "question": "What is the value of 'x' in the equation 2x + 5 = 15?",
                    "options": [
                        "5",
                        "10",
                        "2",
                        "7.5"
                    ],
                    "answer": "5"
                },
                {
                    "question": "A car travels at a speed of 60 km/h. How far will it travel in 3.5 hours?",
                    "options": [
                        "180 km",
                        "210 km",
                        "240 km",
                        "150 km"
                    ],
                    "answer": "210 km"
                },
                {
                    "question": "What is the area of a square with a side length of 7 cm?",
                    "options": [
                        "14 sq cm",
                        "28 sq cm",
                        "49 sq cm",
                        "35 sq cm"
                    ],
                    "answer": "49 sq cm"
                },
                {
                    "question": "If 5 workers can build a wall in 10 days, how many days will 10 workers take to build the same wall? (Assuming work rate is constant)",
                    "options": [
                        "5 days",
                        "7 days",
                        "10 days",
                        "20 days"
                    ],
                    "answer": "5 days"
                },
                {
                    "question": "Which word does not belong with the others? Apple, Banana, Carrot, Orange.",
                    "options": [
                        "Apple",
                        "Banana",
                        "Carrot",
                        "Orange"
                    ],
                    "answer": "Carrot"
                },
                {
                    "question": "If 'CAT' is coded as '3120', how is 'DOG' coded? (A=1, B=2, C=3...)",
                    "options": [
                        "4157",
                        "41520",
                        "4152",
                        "41570"
                    ],
                    "answer": "4157"
                },
                {
                    "question": "Find the next number in the series: 2, 4, 8, 16, ?",
                    "options": [
                        "20",
                        "24",
                        "32",
                        "48"
                    ],
                    "answer": "32"
                },
                {
                    "question": "All pens are pencils. All pencils are erasers. Therefore, all pens are:",
                    "options": [
                        "Pencils",
                        "Erasers",
                        "Papers",
                        "Not pens"
                    ],
                    "answer": "Erasers"
                },
                {
                    "question": "A person walks 10 meters North, then turns East and walks 5 meters. Then turns South and walks 10 meters. In which direction is he from his starting point?",
                    "options": [
                        "North",
                        "South",
                        "East",
                        "West"
                    ],
                    "answer": "East"
                }
            ]
        };

        // Application State
        const app = {
            testDurationMinutes: 45,
            timerInterval: null,
            shuffledQuestions: [],
            userAnswers: {},
            currentQuestionIndex: 0,
            isSubmitted: false
        };

        // DOM Elements
        const elements = {
            questionContent: document.getElementById('question-content'),
            questionIndicator: document.getElementById('question-indicator'),
            timer: document.getElementById('timer'),
            testContainer: document.getElementById('test-container'),
            resultsContainer: document.getElementById('results-container'),
            scoreSummary: document.getElementById('score-summary'),
            answersReview: document.getElementById('answers-review'),
            submitBtn: document.getElementById('submit-btn'),
            retakeBtn: document.getElementById('retake-btn'),
            backToDashboard: document.getElementById('backToDashboard'),
            backToDashboardBtn: document.getElementById('backToDashboardBtn'),
            prevBtn: document.getElementById('prev-btn'),
            nextBtn: document.getElementById('next-btn'),
            progressBar: document.getElementById('progress-bar'),
            currentQuestion: document.getElementById('current-question'),
            totalQuestions: document.getElementById('total-questions'),
            answeredCount: document.getElementById('answered-count'),
            correctCount: document.getElementById('correct-count'),
            incorrectCount: document.getElementById('incorrect-count'),
            unansweredCount: document.getElementById('unanswered-count')
        };

        // Utility Functions
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        function updateProgress() {
            const total = app.shuffledQuestions.length;
            const answered = Object.keys(app.userAnswers).length;
            const percentage = (answered / total) * 100;
            
            elements.progressBar.style.width = `${percentage}%`;
            elements.answeredCount.textContent = `${answered} answered`;
        }

        // Navigation Functions
        function backToDashboard() {
            if (confirm('Are you sure you want to go back to the dashboard? Your current progress will be lost.')) {
                window.location.href = 'index.html';
            }
        }

        // Quiz Functions
        function initializeQuiz() {
            const allQuestions = [...testData.sectionA, ...testData.sectionB];
            app.shuffledQuestions = shuffleArray(allQuestions);
            
            elements.totalQuestions.textContent = app.shuffledQuestions.length;
            
            // Create question indicators
            elements.questionIndicator.innerHTML = '';
            for (let i = 0; i < app.shuffledQuestions.length; i++) {
                const dot = document.createElement('div');
                dot.className = 'indicator-dot';
                dot.setAttribute('data-index', i);
                elements.questionIndicator.appendChild(dot);
            }
            
            renderQuestion();
            updateProgress();
        }

        function renderQuestion() {
            const question = app.shuffledQuestions[app.currentQuestionIndex];
            
            // Update question number
            elements.currentQuestion.textContent = app.currentQuestionIndex + 1;
            
            // Update question indicators
            document.querySelectorAll('.indicator-dot').forEach((dot, index) => {
                dot.classList.remove('active');
                if (index === app.currentQuestionIndex) {
                    dot.classList.add('active');
                }
                if (app.userAnswers[index] !== undefined) {
                    dot.classList.add('answered');
                } else {
                    dot.classList.remove('answered');
                }
            });
            
            // Update navigation buttons
            elements.prevBtn.disabled = app.currentQuestionIndex === 0;
            elements.nextBtn.disabled = app.currentQuestionIndex === app.shuffledQuestions.length - 1;
            
            // Render question content
            elements.questionContent.innerHTML = '';
            
            const questionText = document.createElement('p');
            questionText.className = 'text-lg font-semibold text-white mb-6';
            questionText.textContent = `${app.currentQuestionIndex + 1}. ${question.question}`;
            elements.questionContent.appendChild(questionText);

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options-list space-y-3 flex-grow';
            
            // Store shuffled options to use them in the review
            if (!question.shuffledOptions) {
                question.shuffledOptions = shuffleArray([...question.options]);
            }

            question.shuffledOptions.forEach((option, optionIndex) => {
                const label = document.createElement('label');
                label.className = 'option-label flex items-center p-3 rounded-md cursor-pointer';
                
                const radio = document.createElement('input');
                radio.type = 'radio';
                radio.name = 'current-question';
                radio.value = option;
                radio.id = `option-${optionIndex}`;
                radio.className = 'h-5 w-5 text-indigo-600 focus:ring-indigo-500 border-gray-300';
                
                // Check if this option was previously selected
                if (app.userAnswers[app.currentQuestionIndex] === option) {
                    radio.checked = true;
                    label.classList.add('selected');
                }
                
                // Add event listener to track answer
                radio.addEventListener('change', function() {
                    // Store the answer
                    app.userAnswers[app.currentQuestionIndex] = this.value;
                    
                    // Update visual feedback
                    document.querySelectorAll('.option-label').forEach(label => {
                        label.classList.remove('selected');
                    });
                    this.closest('.option-label').classList.add('selected');
                    
                    // Update progress and indicators
                    updateProgress();
                    document.querySelector(`.indicator-dot[data-index="${app.currentQuestionIndex}"]`).classList.add('answered');
                });
                
                const span = document.createElement('span');
                span.textContent = option;
                span.className = 'ml-3 text-gray-300';
                
                label.appendChild(radio);
                label.appendChild(span);
                optionsDiv.appendChild(label);
            });

            elements.questionContent.appendChild(optionsDiv);
        }
        
        function nextQuestion() {
            if (app.currentQuestionIndex < app.shuffledQuestions.length - 1) {
                app.currentQuestionIndex++;
                renderQuestion();
            }
        }

        function prevQuestion() {
            if (app.currentQuestionIndex > 0) {
                app.currentQuestionIndex--;
                renderQuestion();
            }
        }
        
        function startTimer() {
            let timeLeft = app.testDurationMinutes * 60;
            
            app.timerInterval = setInterval(() => {
                if (timeLeft <= 0) {
                    clearInterval(app.timerInterval);
                    alert("Time's up! Your test has been submitted.");
                    handleSubmit();
                    return;
                }

                timeLeft--;
                elements.timer.textContent = formatTime(timeLeft);
                
                // Add warning class when time is running out
                if (timeLeft <= 300) { // 5 minutes
                    elements.timer.parentElement.classList.add('timer-warning');
                }
            }, 1000);
        }

        function handleSubmit() {
            if (app.isSubmitted) return;
            app.isSubmitted = true;
            
            clearInterval(app.timerInterval);
            
            let score = 0;
            let correct = 0;
            let incorrect = 0;
            let unanswered = 0;
            
            elements.answersReview.innerHTML = ''; // Clear previous review

            app.shuffledQuestions.forEach((q, index) => {
                const selectedOption = app.userAnswers[index] || null;
                const isCorrect = selectedOption === q.answer;

                if (isCorrect) {
                    score++;
                    correct++;
                } else if (selectedOption) {
                    incorrect++;
                } else {
                    unanswered++;
                }

                const reviewBlock = document.createElement('div');
                reviewBlock.className = 'review-block question-block p-6 rounded-lg';
                
                const questionText = document.createElement('p');
                questionText.className = 'text-lg font-semibold text-white mb-4';
                questionText.textContent = `${index + 1}. ${q.question}`;
                reviewBlock.appendChild(questionText);

                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options-list space-y-3';

                const options = q.shuffledOptions || q.options; // Fallback to original options
                options.forEach(option => {
                    const label = document.createElement('label');
                    label.className = 'flex items-center p-3 rounded-md';
                    
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = `review-question-${index}`;
                    radio.value = option;
                    radio.className = 'h-5 w-5 text-indigo-600 focus:ring-indigo-500 border-gray-300';
                    radio.disabled = true;

                    if (option === selectedOption) {
                        radio.checked = true;
                    }
                    
                    const span = document.createElement('span');
                    span.textContent = option;
                    span.className = 'ml-3 text-gray-300';
                    
                    label.appendChild(radio);
                    label.appendChild(span);

                    // Apply highlighting for feedback
                    if (option === q.answer) {
                        label.classList.add('correct-answer');
                    } else if (option === selectedOption) { // The user's incorrect choice
                        label.classList.add('incorrect-answer');
                    }
                    
                    optionsDiv.appendChild(label);
                });
                
                reviewBlock.appendChild(optionsDiv);

                // Add a border to the whole block for quick visual scanning
                if (!selectedOption) {
                    reviewBlock.classList.add('unanswered');
                } else if (isCorrect) {
                    reviewBlock.classList.add('correct-answer');
                } else {
                    reviewBlock.classList.add('incorrect-answer');
                }
                
                elements.answersReview.appendChild(reviewBlock);
            });

            // Update statistics
            elements.correctCount.textContent = correct;
            elements.incorrectCount.textContent = incorrect;
            elements.unansweredCount.textContent = unanswered;

            // Show results
            elements.testContainer.classList.add('hidden');
            elements.resultsContainer.classList.remove('hidden');

            const totalQuestions = app.shuffledQuestions.length;
            const percentage = Math.round((score / totalQuestions) * 100);
            
            elements.scoreSummary.textContent = `You scored ${score} out of ${totalQuestions} (${percentage}%)`;
            
            // Clear existing color classes before adding new ones
            elements.scoreSummary.classList.remove('bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800', 'bg-yellow-100', 'text-yellow-800');

            if (percentage >= 70) {
                elements.scoreSummary.classList.add('bg-green-100', 'text-green-800');
            } else if (percentage >= 40) {
                elements.scoreSummary.classList.add('bg-yellow-100', 'text-yellow-800');
            } else {
                elements.scoreSummary.classList.add('bg-red-100', 'text-red-800');
            }
        }

        function resetQuiz() {
            app.userAnswers = {};
            app.currentQuestionIndex = 0;
            app.isSubmitted = false;
            elements.answersReview.innerHTML = '';
            elements.testContainer.classList.remove('hidden');
            elements.resultsContainer.classList.add('hidden');
            elements.timer.textContent = formatTime(app.testDurationMinutes * 60);
            elements.timer.parentElement.classList.remove('timer-warning');
            initializeQuiz();
            startTimer();
        }

        // Event Listeners
        elements.nextBtn.addEventListener('click', nextQuestion);
        elements.prevBtn.addEventListener('click', prevQuestion);
        
        elements.submitBtn.addEventListener('click', () => {
            // Save current answer before submitting
            const selectedOption = document.querySelector('input[name="current-question"]:checked');
            if (selectedOption) {
                app.userAnswers[app.currentQuestionIndex] = selectedOption.value;
            }
            
            if (confirm('Are you sure you want to submit the test?')) {
                handleSubmit();
            }
        });

        elements.retakeBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to retake the test? Your current progress will be lost.')) {
                resetQuiz();
            }
        });

        elements.backToDashboard.addEventListener('click', backToDashboard);
        elements.backToDashboardBtn.addEventListener('click', backToDashboard);

        // Initialize Quiz
        document.addEventListener('DOMContentLoaded', () => {
            initializeQuiz();
            startTimer();
        });
    </script>
</body>
</html>
